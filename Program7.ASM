INCLUDE LIBMACRO.INC
PROGRAM MASD
.DATA
VC DB 'VVEDIT CHUSLO = ',0
VDOB DB 'DOBYTOK ELEMENTU RYADKIV NA STOVPETS:',0
VST DB 'ELEMENTU STOPTSIA:',0
VN DB 'VVEDIT ROSMIRNIST MATRUTSI. RYADKU N = ',0
VM DB 'VVEDIT ROSMIRNIST MATRUTSI. STOVPTSI M = ',0

K DW ?
N DW ?
M DW ?
S DW ?
MN DW ?
N2 DW ?
M2 DW ?
MAS DW 100 DUP(?)
REZ DW 100 DUP(?)
STOV DW 100 DUP(?)

START
MOV AX,03
INT 10H

;VVEDENNIA DANUX
WLINEZ VN
RWORD N
MOV AX,2
IMUL N
MOV N2,AX
WLINEZ VM
RWORD M
MOV AX,2
IMUL M
MOV M2,AX
MOV AX,N
IMUL M
MOV MN,AX

;ZCHUTUVANNIA MASUVU
MOV CX,MN
MOV SI,0
CKL:
WLINEZ VC
RWORD
MOV MAS[SI],AX
ADD SI,2
LOOP CKL

;VUVEDENNIA MASUVU
;-----------------
MOV CX,N
MOV SI,0
C1:PUSH CX
MOV CX,M
DEC CX
C2:WWORD MAS[SI]
ADD SI,2
;******
MOV AX,M
CMP AX,1
JZ MK2
;******
LOOP C2
WWORDLN MAS[SI]
;******
MK2:MOV AX,M
CMP AX,1
JZ MK3
;******
ADD SI,2
POP CX
LOOP C1
;-----------------

;VVEDENNIA STOVPTSIA
MK3:MOV CX,M
MOV SI,0
CKLST:
WLINEZ VC
RWORD
MOV STOV[SI],AX
ADD SI,2
LOOP CKLST
WLINEZ VST

;VUVEDENNIA STOVPTSIA
;-----------------
MOV CX,M
MOV DI,0
LINEFEED
CKLST1:
WWORD STOV[DI]
LINEFEED
ADD DI,2
LOOP CKLST1
;------------------

MOV CX,N
MOV BX,0
MOV DI,0
CKLZ2:
MOV SI,0
PUSH CX
MOV CX,M
MOV AX,0
MOV S,AX

CKLV2:
MOV DX,STOV[SI]
MOV AX,MAS[BX][SI]
IMUL DX
ADD S,AX
ADD SI,2
LOOP CKLV2

MOV AX,S
MOV REZ[DI],AX
ADD DI,2
MOV AX,M
CMP AX,1
JZ M1
ADD BX,M2
POP CX
LOOP CKLZ2


M1:WLINEZ VDOB
LINEFEED
MOV CX,N
MOV SI,0
CKLVV:
WWORD REZ[SI]
LINEFEED
ADD SI,2
LOOP CKLVV 


PAUSE
RETURN
END MASD